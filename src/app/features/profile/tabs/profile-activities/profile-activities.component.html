<div class="activities-container">
    @if (!canView()) {
    <div class="activities-empty">
        <span class="material-symbols-outlined">lock</span>
        <p>{{ 'profile.privateActivity' | translate }}</p>
    </div>
    } @else {
    <!-- Sticky Filter Bar -->
    <div class="activity-filters">
        <div class="chip-list">
            <button class="chip" [class.active]="activityFilter() === 'ALL'" (click)="setFilter('ALL')">
                {{ 'profile.filterAll' | translate }}
            </button>
            <button class="chip" [class.active]="activityFilter() === 'REVIEWS'" (click)="setFilter('REVIEWS')">
                {{ 'profile.filterReviews' | translate }}
            </button>
            <button class="chip" [class.active]="activityFilter() === 'COMMENTS'" (click)="setFilter('COMMENTS')">
                {{ 'profile.filterComments' | translate }}
            </button>
            <button class="chip" [class.active]="activityFilter() === 'RATINGS'" (click)="setFilter('RATINGS')">
                {{ 'profile.filterRatings' | translate }}
            </button>
            <button class="chip" [class.active]="activityFilter() === 'IMPORTS'" (click)="setFilter('IMPORTS')">
                {{ 'profile.filterImports' | translate }}
            </button>
        </div>
    </div>

    <!-- Activity Feed -->
    @if (isLoading() && activities().length === 0) {
    <div class="activities-loading">
        <div class="spinner"></div>
    </div>
    } @else if (activities().length > 0) {
    <div class="activities-list">
        @for (activity of activities(); track activity._id) {
        <app-activity-card [activity]="activity"></app-activity-card>
        }
    </div>

    @if (hasMore()) {
    <div class="load-more-container">
        <button class="load-more-btn" (click)="loadMore()" [disabled]="isLoading()">
            @if (isLoading()) {
            <span class="spinner-small"></span>
            } @else {
            {{ 'profile.loadMore' | translate }}
            }
        </button>
    </div>
    }
    } @else {
    <div class="activities-empty">
        <span class="material-symbols-outlined">
            @switch (activityFilter()) {
            @case ('REVIEWS') { rate_review }
            @case ('COMMENTS') { chat_bubble }
            @case ('RATINGS') { star }
            @case ('IMPORTS') { folder_open }
            @default { history }
            }
        </span>
        <p>
            @if (!isOwnProfile()) {
            {{ 'profile.noActivitiesOther' | translate }}
            } @else {
            @switch (activityFilter()) {
            @case ('REVIEWS') { {{ 'profile.noReviews' | translate }} }
            @case ('COMMENTS') { {{ 'profile.noComments' | translate }} }
            @case ('RATINGS') { {{ 'profile.noRatings' | translate }} }
            @case ('IMPORTS') { {{ 'profile.noImports' | translate }} }
            @default { {{ 'profile.noActivities' | translate }} }
            }
            }
        </p>
    </div>
    }
    }
</div>